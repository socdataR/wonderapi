<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="wonderapi">
<title>Introduction to wonderapi • wonderapi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to wonderapi">
<meta property="og:description" content="wonderapi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">wonderapi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/D104codebook.html">D104 Heat Wave Days Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D10codebook.html">D10 Natality for 1995 - 2002 Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D149codebook.html">D149 Natality for 2016 - 2022 (expanded) Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D176codebook.html">D176 Provisional Multiple Cause of Death Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D27codebook.html">D27 Natality for 2003 - 2006 Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D66codebook.html">D66 Natality for 2007 - 2022 Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/D76codebook.html">D76 Detailed Mortality Dataset Codebook</a>
    <a class="dropdown-item" href="../articles/IntroVignette.html">Introduction to wonderapi</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/socdataR/wonderapi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to wonderapi</h1>
                        <h4 data-toc-skip class="author">Joyce
Robbins</h4>
            
            <h4 data-toc-skip class="date">2024-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/socdataR/wonderapi/blob/HEAD/vignettes/IntroVignette.Rmd" class="external-link"><code>vignettes/IntroVignette.Rmd</code></a></small>
      <div class="d-none name"><code>IntroVignette.Rmd</code></div>
    </div>

    
    
<div id="TOC">
<ul>
<li>
<a href="#overview">Overview</a>
</li>
<li>
<a href="#installation">Installation</a>
</li>
<li>
<a href="#main-functions">Main functions</a>
</li>
<li>
<a href="#getting-started-with-send_query">Getting started with
<code>send_query()</code></a>
</li>
<li>
<a href="#getting-started-with-getdata">Getting started with
<code>getData()</code></a>
</li>
<ul>
<li>
<a href="#codebooks">Codebooks</a>
</li>
<li>
<a href="#default-query-lists-and-requests">Default query lists and
requests</a>
</li>
<li>
<a href="#creating-customized-queries">Creating customized queries</a>
</li>
<li>
<a href="#group-by-variables">Group By variables</a>
</li>
<li>
<a href="#measures">Measures</a>
</li>
<li>
<a href="#limiting-variables">Limiting variables</a>
</li>
<li>
<a href="#plotting-query-results">Plotting query results</a>
</li>
<li>
<a href="#combining-results-from-multiple-datasets">Combining results
from multiple datasets</a>
</li>
<li>
<a href="#errors">Errors</a>
</li>
</ul>
</ul>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/socdataR/wonderapi" class="external-link">wonderapi</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package makes it easier to use the <a href="https://wonder.cdc.gov/wonder/help/WONDER-API.html" class="external-link">CDC WONDER
API</a>: 1) users can write simple queries using human readable names
rather than numeric codes, and 2) users receive data in a tidy data
frame that is easy to work with.</p>
<p>NOTE, HOWEVER, THAT THE CDC DOES NOT ALLOW QUERIES WITH LOCATION
FIELDS THROUGH THE API. If you wish to limit or group results by Region,
Division, State or County, or Urbanization, use the <a href="https://wonder.cdc.gov/" class="external-link">CDC Wonder</a> web interface rather than
the API – either with or without this package. For more information on
this limitation, see: <a href="https://wonder.cdc.gov/wonder/help/WONDER-API.html" class="external-link">https://wonder.cdc.gov/wonder/help/WONDER-API.html</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package is not on CRAN. It can be installed from Github with the
<code>remotes</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"socdataR/wonderapi"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>(If you have trouble installing the vignettes, or prefer not to, you
can access them on <a href="https://socdatar.github.io/wonderapi/" class="external-link">the
package website</a> under the Articles tab instead.)</p>
</div>
<div class="section level2">
<h2 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<p><code><a href="../reference/send_query.html">send_query()</a></code> – takes as input an <code>.xml</code> file
exported from the CDC Wonder web interface</p>
<p><code><a href="../reference/getData.html">getData()</a></code> – takes as input an R list of query
options</p>
<p><code><a href="../reference/show_databases.html">show_databases()</a></code> displays available databases by name
and code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">wonderapi</span><span class="fu">::</span><span class="fu"><a href="../reference/show_databases.html">show_databases</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 2</span></span></span>
<span><span class="co">##   label                               name </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Natality for 1995 - 2002            D10  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Natality for 2003 - 2006            D27  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Natality for 2007 - 2022            D66  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Natality for 2016 - 2022 (expanded) D149 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Detailed Mortality                  D76  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Provisional Multiple Cause of Death D176 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> Heat Wave Days                      D104</span></span></code></pre>
<p>(Applies only to <code><a href="../reference/getData.html">getData()</a></code>. Any database can be used
with <code><a href="../reference/send_query.html">send_query()</a></code>.)</p>
<p>More databases will be added in the future.</p>
<p>The best way to become familiar with <a href="https://wonder.cdc.gov/wonder/help/WONDER-API.html" class="external-link">CDC WONDER
API</a> options is to use the <a href="https://wonder.cdc.gov" class="external-link">CDC
WONDER</a> web interface, as the options available through the API are
nearly identical (except for the location variable limitation – see
above).</p>
</div>
<div class="section level2">
<h2 id="getting-started-with-send_query">Getting started with <code>send_query()</code><a class="anchor" aria-label="anchor" href="#getting-started-with-send_query"></a>
</h2>
<p>This function requires an <code>.xml</code> query request file. To
obtain this file, create a query on <a href="https://wonder.cdc.gov/" class="external-link">CDC WONDER</a>. Before clicking “Send”,
uncheck the “Show totals” button at the bottom, and take note of the
database code starting with “D” at the end of the URL.</p>
<p>After sending the query, click the “API Options” tab and then the
“Export API” button to download the query <code>.xml</code>.</p>
<p>Once you have this file, you can use it with the
<code><a href="../reference/send_query.html">send_query()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/send_query.html">send_query</a></span><span class="op">(</span><span class="st">"D76"</span>, <span class="st">"Underlying Cause of Death, 1999-2020_1710519087439-req.xml"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 44 × 5</span></span></span>
<span><span class="co">##    Year  Gender Deaths Population `Crude Rate`</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1999  Female  <span style="text-decoration: underline;">12</span>291    1<span style="text-decoration: underline;">932</span>563          6.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1999  Male    <span style="text-decoration: underline;">15</span>646    2<span style="text-decoration: underline;">026</span>854          7.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 2000  Female  <span style="text-decoration: underline;">12</span>317    1<span style="text-decoration: underline;">981</span>845          6.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 2000  Male    <span style="text-decoration: underline;">15</span>718    2<span style="text-decoration: underline;">076</span>969          7.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 2001  Female  <span style="text-decoration: underline;">12</span>091    1<span style="text-decoration: underline;">968</span>011          6.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 2001  Male    <span style="text-decoration: underline;">15</span>477    2<span style="text-decoration: underline;">057</span>922          7.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 2002  Female  <span style="text-decoration: underline;">12</span>317    1<span style="text-decoration: underline;">963</span>747          6.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 2002  Male    <span style="text-decoration: underline;">15</span>717    2<span style="text-decoration: underline;">057</span>979          7.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 2003  Female  <span style="text-decoration: underline;">12</span>123    1<span style="text-decoration: underline;">996</span>415          6.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 2003  Male    <span style="text-decoration: underline;">15</span>902    2<span style="text-decoration: underline;">093</span>535          7.6</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 34 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="getting-started-with-getdata">Getting started with <code>getData()</code><a class="anchor" aria-label="anchor" href="#getting-started-with-getdata"></a>
</h2>
<p>Queries are composed of parameter name-value pairs:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"And By"</span>, <span class="st">"Gender"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Detailed Mortality"</span>, <span class="va">mylist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">##   Year  Gender  Deaths Population `Crude Rate`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1999  Female 1<span style="text-decoration: underline;">215</span>860  142<span style="text-decoration: underline;">237</span>295         855.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 1999  Male   1<span style="text-decoration: underline;">175</span>183  136<span style="text-decoration: underline;">802</span>873         859 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2000  Female 1<span style="text-decoration: underline;">225</span>706  143<span style="text-decoration: underline;">368</span>343         855.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2000  Male   1<span style="text-decoration: underline;">177</span>289  138<span style="text-decoration: underline;">053</span>563         853.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2001  Female 1<span style="text-decoration: underline;">232</span>913  145<span style="text-decoration: underline;">077</span>463         850.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 2001  Male   1<span style="text-decoration: underline;">183</span>090  139<span style="text-decoration: underline;">891</span>492         846.</span></span></code></pre>
<div class="section level3">
<h3 id="codebooks">Codebooks<a class="anchor" aria-label="anchor" href="#codebooks"></a>
</h3>
<p>Codebooks are provided as package vignettes to allow the user to
conveniently look up the names and values of available parameters in
each dataset. They may be accessed quickly by typing:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="sc">&gt;</span> ??codebook</span></code></pre></div>
<p>in the console, or searching for “<code>codebook</code>” in the Help
window. They are also available under the “Articles” tab of the <a href="https://socdatar.github.io/wonderapi/" class="external-link">package website</a>.</p>
<p>The codebooks are an important contribution of the package and are
not provided by the CDC. They are generated automatically by <a href="https://github.com/socdataR/wonderapi/blob/main/R/make_codebook_vignette.R" class="external-link">this
script</a>, which scrapes the <a href="https://wonder.cdc.gov/" class="external-link">CDC
WONDER</a> web interface form, and displays parameter names and values
in human readable form. The benefit of this method is the ability to
quickly produce and update codebook vignettes that closely follow the
web interface, with parameters appearing in the same order. It also
means, however, that the codebooks contain more information than the
typical user needs to submit a query. Most users will only need Group By
variables (codes beginning with “B_”), Measures (codes beginning with
“M_”), and Limiting Variables (codes beginning with “V_”).</p>
<p>Although some of the parameter names are long and/or awkward, for the
sake of consistency, we follow the CDC names exactly. <strong>The only
exception is that any content that appears in parentheses should be
dropped.</strong> For example, “Fertility Rate” can be substituted for
“M_5”, but “Fertility Rate (Census Region, Census Division, HHS Region,
State, County, Year, Age of Mother, Race) cannot.</p>
</div>
<div class="section level3">
<h3 id="default-query-lists-and-requests">Default query lists and requests<a class="anchor" aria-label="anchor" href="#default-query-lists-and-requests"></a>
</h3>
<p>To facilitate the process of designing a query list, this package
relies on default query lists. Each default query is set to request a
single Group By Results parameter, generally set to <code>"Year"</code>.
It is set to request the Measures that are listed as default Measures on
the web interface (i.e. <code>Births</code> for <a href="https://wonder.cdc.gov/controller/datarequest/D76" class="external-link">the Births
dataset</a>; <code>Deaths</code>, <code>Population</code> and
<code>Crude Rate</code> for the <a href="https://wonder.cdc.gov/controller/datarequest/D76" class="external-link">Detailed
Mortality dataset</a>.) To see the default settings, perform a query
request without specifying a querylist:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">natdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2007 - 2022"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">natdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">##    Year  Births</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>007 4<span style="text-decoration: underline;">316</span>233</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>008 4<span style="text-decoration: underline;">247</span>694</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>009 4<span style="text-decoration: underline;">130</span>665</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>010 3<span style="text-decoration: underline;">999</span>386</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>011 3<span style="text-decoration: underline;">953</span>590</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>012 3<span style="text-decoration: underline;">952</span>841</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Detailed Mortality"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dmdata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   Year   Deaths Population `Crude Rate`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1999  2<span style="text-decoration: underline;">391</span>043  279<span style="text-decoration: underline;">040</span>168         857.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2000  2<span style="text-decoration: underline;">402</span>995  281<span style="text-decoration: underline;">421</span>906         854.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2001  2<span style="text-decoration: underline;">416</span>003  284<span style="text-decoration: underline;">968</span>955         848.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2002  2<span style="text-decoration: underline;">443</span>030  287<span style="text-decoration: underline;">625</span>193         849.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2003  2<span style="text-decoration: underline;">447</span>946  290<span style="text-decoration: underline;">107</span>933         844.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 2004  2<span style="text-decoration: underline;">397</span>269  292<span style="text-decoration: underline;">805</span>298         819.</span></span></code></pre>
<p>The default lists were prepared based on CDC examples, but we make no
claim that they are error free. If you have any suggestions for
improving them, please make a pull request on Github or open an issue.
The default lists are available in the <a href="https://github.com/socdataR/wonderapi/tree/main/data-raw" class="external-link">/data-raw
folder</a>.</p>
</div>
<div class="section level3">
<h3 id="creating-customized-queries">Creating customized queries<a class="anchor" aria-label="anchor" href="#creating-customized-queries"></a>
</h3>
<p>There are different types of parameters. Most critical are Group
Results By and Measures. The Group Results By parameters serve as keys
for grouping the data; the maximum number of Group Results By parameters
is five. Limiting Variables may also be used to constrain results behind
the scenes.</p>
<p>To make changes to the default list, first create a list of lists,
wherein each nested list is a name-value pair. For example, the
following changes the first (and currently only) “Group Results By”
variable to Weekday:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group Results By"</span>, <span class="st">"Weekday"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Detailed Mortality"</span>, <span class="va">mylist</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   Weekday    Deaths Population     `Crude Rate`  </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Sunday    8<span style="text-decoration: underline;">049</span>406 Not Applicable Not Applicable</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Monday    8<span style="text-decoration: underline;">120</span>828 Not Applicable Not Applicable</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Tuesday   8<span style="text-decoration: underline;">066</span>322 Not Applicable Not Applicable</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Wednesday 8<span style="text-decoration: underline;">074</span>854 Not Applicable Not Applicable</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Thursday  8<span style="text-decoration: underline;">087</span>969 Not Applicable Not Applicable</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Friday    8<span style="text-decoration: underline;">197</span>715 Not Applicable Not Applicable</span></span></code></pre>
<p>As the set up is slightly different depending on the parameter type,
more details on setting up the name-value pairs by parameter types are
provided below.</p>
</div>
<div class="section level3">
<h3 id="group-by-variables">Group By variables<a class="anchor" aria-label="anchor" href="#group-by-variables"></a>
</h3>
<p>Each dataset allows for fixed number (5 or fewer) Group By variables,
codes for which are <code>"B_1", "B_2", "B_3",</code> etc.
<code>"Group By Results"</code> may be substituted for
<code>"B_1"</code> and <code>"And By"</code> for <code>"B_2"</code>.
<code>"And By</code>” may <strong>not</strong>, however, be substituted
for <code>"B_3"</code> on to avoid ambiguity (this may change in the
future.) Values – in this case, the Group By variables – may be
specified by code or human readable name. The following, thus, are
equivalent:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## not run</span></span>
<span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"B_1"</span>, <span class="st">"D66.V2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group Results By"</span>, <span class="st">"Race"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"B_1"</span>, <span class="st">"Race"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group Results By"</span>, <span class="st">"D66.V2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>See the appropriate codebook for all Group By options.</p>
</div>
<div class="section level3">
<h3 id="measures">Measures<a class="anchor" aria-label="anchor" href="#measures"></a>
</h3>
<p>Measures do not need values; it is sufficient to specify a name
only:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group Results By"</span>, <span class="st">"Marital Status"</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"And By"</span>, <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Average Age of Mother"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2007 - 2022"</span>, <span class="va">mylist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   `Marital Status`  Year  Births `Average Age of Mother`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Married           <span style="text-decoration: underline;">2</span>007 2<span style="text-decoration: underline;">601</span>186                    29.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Married           <span style="text-decoration: underline;">2</span>008 2<span style="text-decoration: underline;">521</span>128                    29.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Married           <span style="text-decoration: underline;">2</span>009 2<span style="text-decoration: underline;">437</span>007                    29.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Married           <span style="text-decoration: underline;">2</span>010 2<span style="text-decoration: underline;">365</span>915                    29.8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Married           <span style="text-decoration: underline;">2</span>011 2<span style="text-decoration: underline;">345</span>817                    29.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Married           <span style="text-decoration: underline;">2</span>012 2<span style="text-decoration: underline;">343</span>222                    30.0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="limiting-variables">Limiting variables<a class="anchor" aria-label="anchor" href="#limiting-variables"></a>
</h3>
<p>Queries can be constrained with parameters that limit results in the
background. For example, if you’re only interested in February births,
you may choose to limit results to February as follows, rather than
grouping by Month:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Month"</span>, <span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"D66"</span>, <span class="va">mylist</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 16 × 2</span></span></span>
<span><span class="co">##     Year Births</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>007 <span style="text-decoration: underline;">326</span>891</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>008 <span style="text-decoration: underline;">338</span>521</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>009 <span style="text-decoration: underline;">316</span>641</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>010 <span style="text-decoration: underline;">301</span>994</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>011 <span style="text-decoration: underline;">297</span>961</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">304</span>505</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>013 <span style="text-decoration: underline;">291</span>748</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>014 <span style="text-decoration: underline;">298</span>404</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>015 <span style="text-decoration: underline;">298</span>058</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>016 <span style="text-decoration: underline;">306</span>015</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">2</span>017 <span style="text-decoration: underline;">289</span>054</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">2</span>018 <span style="text-decoration: underline;">284</span>250</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">279</span>963</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">2</span>020 <span style="text-decoration: underline;">282</span>654</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">2</span>021 <span style="text-decoration: underline;">266</span>355</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">2</span>022 <span style="text-decoration: underline;">275</span>727</span></span></code></pre>
<p><strong>Note that values for Limiting Variables must be entered as
codes; in this case “2” rather than “February.” We hope to add
capability for human readable values in the future.</strong></p>
</div>
<div class="section level3">
<h3 id="plotting-query-results">Plotting query results<a class="anchor" aria-label="anchor" href="#plotting-query-results"></a>
</h3>
<p>By returning a tidy data frame, the query results are ready to be
plotted without any additional data manipulation:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydata2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Births</span>, color <span class="op">=</span> <span class="va">`Marital Status`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Births by Marital Status"</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroVignette_files/figure-html/BirthsByMaritalStatus-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydata2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">`Average Age of Mother`</span>, color <span class="op">=</span> <span class="va">`Marital Status`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average Age of Mother"</span>, y <span class="op">=</span> <span class="st">"age (in years)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroVignette_files/figure-html/AverageAgeofMother-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata2</span> <span class="op">&lt;-</span> <span class="va">mydata2</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">`Average Age of Mother`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">`Marital Status`</span>, value <span class="op">=</span> <span class="va">`Births`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Total <span class="op">=</span> <span class="va">Married</span> <span class="op">+</span> <span class="va">Unmarried</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mydata2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Unmarried</span> <span class="op">/</span> <span class="va">Total</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Births to Unmarried Mothers"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Percent of Total Births"</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroVignette_files/figure-html/BirthstoUnmarriedMothers-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="combining-results-from-multiple-datasets">Combining results from multiple datasets<a class="anchor" aria-label="anchor" href="#combining-results-from-multiple-datasets"></a>
</h3>
<p>Some of the datasets, such as the Births, are divided into multiple
databases by time period. <code>wonderapi</code> makes it easy to
combine the data into one data frame. (Care needs to be taken as the
variables are not identical in all. For example, the 1995 - 2002 dataset
does not have any measure options; it only returns number of births. To
find out what’s available, see the codebooks
(<strong><code>&gt;??codebook</code></strong>) and crosscheck with the
<a href="https://wonder.cdc.gov" class="external-link">CDC Wonder</a> web interface.)</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">births</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 1995 - 2002"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2003 - 2006"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2007 - 2022"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">births</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Births</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"U.S. Births by Year, 1995 - 2022"</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroVignette_files/figure-html/BirthsbyYear-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="errors">Errors<a class="anchor" aria-label="anchor" href="#errors"></a>
</h3>
<p>The main source of errors is improper query requests. The
<code>wonderapi</code> package has some ability to catch problems before
the query request is made but will not catch everything. It checks the
list of parameter names and will reject the name-value pair if the
<em>name</em>, either in code or human readable form, is not recognized
or is a geographic variable not accessible through the API without
permission. (Checking for <em>value</em> problems will be added in the
future.) Here is an example of an unrecognized parameter name:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Detailed Mortality"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Suspect"</span>, <span class="st">"Mrs. Peacock"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Couldn't find: "Suspect" but including anyway.</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   Year   Deaths Population `Crude Rate`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1999  2<span style="text-decoration: underline;">391</span>043  279<span style="text-decoration: underline;">040</span>168         857.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2000  2<span style="text-decoration: underline;">402</span>995  281<span style="text-decoration: underline;">421</span>906         854.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2001  2<span style="text-decoration: underline;">416</span>003  284<span style="text-decoration: underline;">968</span>955         848.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2002  2<span style="text-decoration: underline;">443</span>030  287<span style="text-decoration: underline;">625</span>193         849.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2003  2<span style="text-decoration: underline;">447</span>946  290<span style="text-decoration: underline;">107</span>933         844.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 2004  2<span style="text-decoration: underline;">397</span>269  292<span style="text-decoration: underline;">805</span>298         819.</span></span></code></pre>
<p>If the <a href="https://wonder.cdc.gov/wonder/help/WONDER-API.html" class="external-link">CDC WONDER
API</a> returns an error, the message in the response will be displayed.
Sometimes the message will provide enough information to fix the
problem. Other times, it is not. For example:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"And By"</span>, <span class="st">"Education"</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Birth Rate"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2007 - 2022"</span>, <span class="va">mylist</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Message from query:</span></span>
<span><span class="co">## Any by-variables picked from {0} need to appear in the order listed, and other by-variables can't come between them.</span></span></code></pre>
<pre><code><span><span class="co">## Error in getData("Natality for 2007 - 2022", mylist): Internal Server Error (HTTP 500).</span></span></code></pre>
<p>In this case, the best approach is to visit <a href="https://wonder.cdc.gov" class="external-link">CDC WONDER</a> and try the same query. If
all goes well, you will receive more detailed information on what went
wrong:</p>
<center>
<img src="NatalityError.png" width="432px">
</center>
<p>We learn that we can’t include “Education” if we request the “Birth
Rate” measure. If we try again with “Bridged Race” instead of
“Education”, it works:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"And By"</span>, <span class="st">"Mother's Bridged Race"</span><span class="op">)</span>, </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Birth Rate"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getData.html">getData</a></span><span class="op">(</span><span class="st">"Natality for 2007 - 2022"</span>, <span class="va">mylist</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mydata5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">##    Year `Mother's Bridged Race`           Births `Total Population` `Birth Rate`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>007 American Indian or Alaska Native   <span style="text-decoration: underline;">49</span>443 3,829,898          12.91       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>007 Asian or Pacific Islander         <span style="text-decoration: underline;">254</span>488 15,559,373         16.36       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>007 Black or African American         <span style="text-decoration: underline;">675</span>676 40,451,108         16.70       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>007 White                            3<span style="text-decoration: underline;">336</span>626 241,390,828        13.82       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>008 American Indian or Alaska Native   <span style="text-decoration: underline;">49</span>537 3,983,929          12.43       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>008 Asian or Pacific Islander         <span style="text-decoration: underline;">253</span>185 16,094,699         15.73</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joyce Robbins.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
